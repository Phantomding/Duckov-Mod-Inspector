# 🦆 Duckov Security Scanner

**Duckov Security Scanner** 是一个专为《逃离鸭科夫》(Escape from Duckov) 社区开发的开源 Mod 安全检测工具。

针对近期社区中出现的恶意 Mod（如 Scav 模式内置病毒、逻辑炸弹、针对性坏档代码等），本工具通过**静态代码分析**与**行为特征扫描**，帮助玩家在安装 Mod 前识别潜在风险，守卫你的硬盘与存档。

> ⚠️ **v1.2.0 重要更新**：本版本大幅重构了检测引擎，移除了泛用的模糊规则，显著降低了误报率，并引入了对 Harmony 库的智能识别。

---

## ✨ 核心功能 (Features)

### 1. 🎯 精准行为检测 (Precision Analysis)
不再进行“有罪推定”。v1.2 版本仅针对确凿的恶意行为特征进行报警：
* **反逻辑炸弹**：检测 `Application.Quit`、`Environment.Exit` 等强制退出游戏或破坏存档的代码。
* **隐私与系统保护**：识别 `Process.Start`（启动外部程序）、`WebClient.Upload`（数据外传）等高危操作。
* **恶意鉴权拦截**：扫描针对特定 SteamID 的黑名单/封禁逻辑。

### 2. 🛡️ 伪装病毒查杀 (Anti-Disguise)
* **原生病毒拦截**：检测伪装成 C# Mod (`.dll`) 的 C++/Native 原生病毒（针对 Scav 1.5 变种），通过校验 `.NET` 元数据签名 (BSJB) 直接秒杀此类伪装。
* **混淆/加密识别**：分析文件信息密度与可读性，识别经过高强度混淆或加壳的可疑文件。

### 3. 🤝 智能白名单 (Smart Whitelist)
* **Harmony 特权豁免**：智能识别合法的 `0Harmony.dll` 及其变种，允许其进行必要的内存补丁操作 (`VirtualProtect`)，不再误伤 Mod 运行的基石。
* **官方库过滤**：自动忽略 Unity 官方引擎库与系统基础库。

---

## 🚀 使用方法 (Usage)

1.  下载最新版本的 `DuckovSecurity.exe`。
2.  双击运行程序。
3.  **将 Mod 文件夹（或包含 dll 的文件夹）直接拖入软件窗口**。
4.  等待扫描完成（通常仅需几秒），查看右侧报告。

### 📊 报告解读
* 🟢 **安全 (Safe)**：未发现已知威胁或敏感行为。
* 🟡 **警告 (Warning)**：发现敏感操作（如底层调用、网络行为），但可能是 Mod 功能所需。建议核对 Mod 来源。
* 🔴 **高危 (High Risk)**：发现明确的恶意特征（如强制闪退、原生伪装）。**强烈建议不要安装该 Mod。**

---

## 🛠️ v1.2.0 更新日志 (Changelog)

**"从宁错杀到精准狙击"**

* **[优化] 告别高误报**：移除了 `System.Diagnostics` (计时器) 和 `System.Net` (基础网络) 的泛用检测规则。现在正常的性能优化类 Mod 不会再爆红。
* **[新增] 细粒度规则**：新增对 `Process.Start`、`Directory.Delete` 等具体破坏性行为的检测。
* **[修复] Harmony 误判**：修复了对修改版/内嵌版 `0Harmony` 库的误报问题。
* **[调整] 客观报告**：UI 文案调整，将“发现病毒”更为客观地描述为“发现敏感行为”或“架构异常”，将判断权交还给用户。

---

## ⚖️ 局限性与设计哲学 (Limitations)

为了公开透明，我们需要说明本工具的边界：

1.  **它不是杀毒软件**：本工具专注于检测**“在游戏语境下的恶意行为”**（例如：在游戏 Mod 里写“退出程序”是恶意的，但在普通软件里是正常的）。它无法替代 Windows Defender 或 360 查杀传统的木马病毒。
2.  **静态分析的局限**：本工具基于静态特征扫描。如果恶意代码使用了极高等级的动态混淆、内存注入或云端热加载攻击，可能会绕过检测。
3.  **辅助决策**：工具的目的是提高攻击者的门槛，并帮小白玩家筛掉 90% 的低级恶意 Mod。**即使扫描全绿，也请务必只从可信赖的渠道（如官方群、知名作者）下载 Mod。**

---

## 🤝 贡献与反馈 (Contribution)

本项目完全开源，欢迎社区开发者共同维护：

* 如果你发现了新的恶意 Mod 样本，欢迎提交 Issue。
* 如果你有更好的检测算法或降噪逻辑，欢迎提交 Pull Request。

---

## 📄 免责声明 (Disclaimer)

本软件按“原样”提供，不提供任何形式的明示或暗示担保。开发者不对因使用本软件或根据本软件的检测结果而导致的任何数据丢失、系统损坏或游戏封号承担责任。**Mod 行为千变万化，请始终保持警惕。**

Copyright © 2025 Duckov Security Team.
